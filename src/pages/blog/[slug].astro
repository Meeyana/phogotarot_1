---
// 1. Import Layout
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// 2. Code logic cũ của bạn (Giữ nguyên)
export async function getStaticPaths() {
 const allPosts = await getCollection('blog');
 return allPosts.map(post => ({
  params: { slug: post.slug },
  props: { post },
 }));
}
const { post } = Astro.props;
const { Content } = await post.render();

// 3. (THÊM PHẦN NÀY) TẠO SCHEMA JSON-LD Ở ĐÂY
const schema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": post.data.title, // <-- Biến được xử lý chính xác ở đây
  "description": post.data.excerpt, // <-- Biến được xử lý chính xác ở đây
  "image": new URL(post.data.image, Astro.site).href, // <-- Lấy URL đầy đủ
  "author": {
    "@type": "Organization",
    "name": "Phở Gõ Tarot"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Phở Gõ Tarot",
    "logo": {
      "@type": "ImageObject",
      "url": "https://phogotarot.com/images/logo.png"
    }
  }
  // (Bạn có thể thêm "datePublished": post.data.pubDate nếu có)
};
---

<BaseLayout
  title={`${post.data.title} - Phở Gõ Tarot`}
  description={post.data.excerpt}
  ogImage={post.data.image}
>
    <main id="homepage-content">
    <section class="homepage-section" style="padding-top: 6rem; min-height: 80vh;">
      <div class="container" style="max-width: 800px;">         <h1 class="hero-title">{post.data.title}</h1>
        <img src={post.data.image} alt={post.data.title} class="section-image" />

        <div id="post-content">
          <Content />
        </div>

        <a href="/blog" class="btn-outline" style="margin-top: 3rem;">&larr; Quay lại danh sách Blog</a>
      </div>
    </section>
  </main>
    
    <script 
      type="application/ld+json" 
      slot="head"
      set:html={JSON.stringify(schema)}
    />

    <style>
        .homepage-section { padding: 4rem 2rem; position: relative; z-index: 1; }
        .container { max-width: 800px; margin: auto; padding: 0 1rem; }
        .hero-title { font-family: var(--font-title); color: var(--title-color); font-size: 3rem; margin-bottom: 1.5rem; text-align: center; }
        .section-image { width: 100%; height: auto; max-height: 400px; border-radius: 12px; object-fit: cover; margin-bottom: 2.5rem; }
        .btn-outline { display: inline-block; background: transparent; border: 1px solid var(--card-back-border); color: var(--title-color); padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; text-decoration: none; text-shadow: none; }

        #post-content {
          font-size: 1.1rem; line-height: 1.8; text-shadow: none;
          text-align: left;
        }
        #post-content h2, #post-content h3 {
          font-family: var(--font-title); color: var(--title-color);
          margin-top: 2.5rem; margin-bottom: 1rem;
        }
        #post-content p { margin-bottom: 1.5rem; }
        #post-content ul, #post-content ol { padding-left: 2rem; margin-bottom: 1.5rem; }
        #post-content :global(img) {
            width: 100%;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 2rem 0;
            border: 1px solid var(--card-back-border);
        }
  </style>
</BaseLayout>